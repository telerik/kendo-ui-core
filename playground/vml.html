<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:v="urn:schemas-microsoft-com:v">
    <head>
        <title>VML Oval</title>
        <style type="text/css">
            v\:* {
                behavior: url(#default#VML);
            }
        </style>
    </head>
    <body>
        <div>
            <div style="position: absolute; top: 0px; left: 0px;">
                <v:shape strokecolor="blue" fillcolor="blue" coordorigin="0 0" coordsize="100 100"
                         style="position: absolute; width:100px;height:100px">
                    <v:path v="m 0,0 l 0,100 l 100,100 l 100,0 x e" />
                </v:shape>
                <v:shape stroked="false" fillcolor="#fff" coordorigin="0 0" coordsize="100 100"
                style="position: absolute; width:100px;height:100px;
                       filter:'progid:DXImageTransform.Microsoft.Alpha(opacity=30,style=1,finishOpacity=10,startx=0,starty=0,finishx=100,finishy=0)' ">
                    <v:path v="m 2,98 l 2,2 l 98,2 c 98,2 48,10 2,98 x e"/>
                </v:shape>
            </div>
            <div style="position: absolute; top: 0px; left: 110px;">
                <v:shape strokecolor="blue" coordorigin="0 0" coordsize="100 400"
                         style="position: absolute; width:100px;height:400px">
                    <v:path v="m 0,0 l 0,400 l 100,400 l 100,0 x e" />
                </v:shape>
                <v:shape strokecolor="red" coordorigin="0 0" coordsize="100 400"
                         style="position: absolute; width:100px;height:400px">
                    <v:path v="m 2,398 l 2,2 l 98,2 c 98,2 48,40 2,398 x e"/>
                </v:shape>
            </div>
            <v:shapetype id="gradient">
                <v:fill type="gradient"
                colors="5% #99c62a, 10% #99c62a, 25% #c2dd80, 92% #99c62a, 93% #add155, 100% #c2dd80",
                angle="90" />
            </v:shapetype>
            <div style="position: absolute; top: 0px; left: 220px;">
                <v:shape strokecolor="blue" coordorigin="0 0" coordsize="100 400"
                         type="#gradient"
                         style="position: absolute; width:100px;height:400px">
                    <v:path v="m 0,0 l 0,400 l 100,400 l 100,0 x e" />
                    <!--
                        newColor = alpha * oldColor + (1 - alpha) * WHITE
                        base color: #99c62a = rgb(153, 198, 42)

                        a = 0 => 99c62a

                        a = 0.2 =>
                            r = 0.2 * 255 + 0.8 * 153 = ad
                            g = 0.2 * 255 + 0.8 * 198 = d1
                            b = 0.2 * 255 + 0.8 * 42 = 55

                        a = 0.4 =>
                            r = 0.4 * 255 + 0.6 * 153 = c2
                            g = 0.4 * 255 + 0.6 * 198 = dd
                            b = 0.4 * 255 + 0.6 * 42 = 80
                    -->
                </v:shape>
            </div>

            <div id="holder"></div>
            <div id="time">
                <span id="h"></span>:<span id="m"></span>:<span id="s"></span> <span id="ampm"></span> Â· <span id="d"></span>/<span id="mnth"></span>
            </div>

            <script src="raphael.js"></script>
            <script>
                window.onload = function () {
                    var r = Raphael("holder", 600, 600),
                    R = 200,
                    init = true,
                    param = {stroke: "#fff", "stroke-width": 30},
                    hash = document.location.hash,
                    marksAttr = {fill: hash || "#444", stroke: "none"},
                    html = [
                    document.getElementById("h"),
                    document.getElementById("m"),
                    document.getElementById("s"),
                    document.getElementById("d"),
                    document.getElementById("mnth"),
                    document.getElementById("ampm")
                    ];
                    // Custom Attribute
                    r.customAttributes.arc = function (value, total, R) {
                        var alpha = 360 / total * value,
                        a = (90 - alpha) * Math.PI / 180,
                        x = 300 + R * Math.cos(a),
                        y = 300 - R * Math.sin(a),
                        color = "hsb(".concat(Math.round(R) / 200, ",", value / total, ", .75)"),
                        path;
                        if (total == value) {
                            path = [["M", 300, 300 - R], ["A", R, R, 0, 1, 1, 299.99, 300 - R]];
                            } else {
                            path = [["M", 300, 300 - R], ["A", R, R, 0, +(alpha > 180), 1, x, y]];
                        }
                        return {path: path, stroke: color};
                    };

                    drawMarks(R, 60);
                    var sec = r.path().attr(param).attr({arc: [0, 60, R]});
                    R -= 40;
                    drawMarks(R, 60);
                    var min = r.path().attr(param).attr({arc: [0, 60, R]});
                    R -= 40;
                    drawMarks(R, 12);
                    var hor = r.path().attr(param).attr({arc: [0, 12, R]});
                    console.log(hor);
                    R -= 40;
                    drawMarks(R, 31);
                    var day = r.path().attr(param).attr({arc: [0, 31, R]});
                    R -= 40;
                    drawMarks(R, 12);
                    var mon = r.path().attr(param).attr({arc: [0, 12, R]});
                    var pm = r.circle(300, 300, 16).attr({stroke: "none", fill: Raphael.hsb2rgb(15 / 200, 1, .75).hex});
                    html[5].style.color = Raphael.hsb2rgb(15 / 200, 1, .75).hex;

                    function updateVal(value, total, R, hand, id) {
                        if (total == 31) { // month
                            var d = new Date;
                            d.setDate(1);
                            d.setMonth(d.getMonth() + 1);
                            d.setDate(-1);
                            total = d.getDate();
                        }
                        var color = "hsb(".concat(Math.round(R) / 200, ",", value / total, ", .75)");
                        if (init) {
                            hand.animate({arc: [value, total, R]}, 900, ">");
                            } else {
                            if (!value || value == total) {
                                value = total;
                                hand.animate({arc: [value, total, R]}, 750, "bounce", function () {
                                    hand.attr({arc: [0, total, R]});
                                });
                                } else {
                                hand.animate({arc: [value, total, R]}, 750, "elastic");
                            }
                        }
                        html[id].innerHTML = (value < 10 ? "0" : "") + value;
                        html[id].style.color = Raphael.getRGB(color).hex;
                    }

                    function drawMarks(R, total) {
                        if (total == 31) { // month
                            var d = new Date;
                            d.setDate(1);
                            d.setMonth(d.getMonth() + 1);
                            d.setDate(-1);
                            total = d.getDate();
                        }
                        var color = "hsb(".concat(Math.round(R) / 200, ", 1, .75)"),
                        out = r.set();
                        for (var value = 0; value < total; value++) {
                            var alpha = 360 / total * value,
                            a = (90 - alpha) * Math.PI / 180,
                            x = 300 + R * Math.cos(a),
                            y = 300 - R * Math.sin(a);
                            out.push(r.circle(x, y, 2).attr(marksAttr));
                        }
                        return out;
                    }

                    (function () {
                        var d = new Date,
                        am = (d.getHours() < 12),
                        h = d.getHours() % 12 || 12;
                        updateVal(d.getSeconds(), 60, 200, sec, 2);
                        updateVal(d.getMinutes(), 60, 160, min, 1);
                        updateVal(h, 12, 120, hor, 0);
                        updateVal(d.getDate(), 31, 80, day, 3);
                        updateVal(d.getMonth() + 1, 12, 40, mon, 4);
                        pm[(am ? "hide" : "show")]();
                        html[5].innerHTML = am ? "AM" : "PM";
                        setTimeout(arguments.callee, 1000);
                        init = false;
                    })();
                };
            </script>
       </div>
    </body>
</html>

